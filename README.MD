Este projeto ainda esta em desenvolvimento todo cuidado e atenÃ§Ã£o no seu uso.
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RODA FÃ”NICA       â”‚ â† Pulsos do sensor Hall
â”‚ (decoder_padrao.h)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Atualiza: rpm, posicao_atual_sensor, 
           â”‚          revolucoes_sincronizada, tempo_cada_grau
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      TIMER1         â”‚ â† Executa a cada 100Âµs
â”‚    (timer.h)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Usa as variÃ¡veis da roda fÃ´nica para:
           â”‚ - Calcular timing de igniÃ§Ã£o/injeÃ§Ã£o
           â”‚ - Acionar bobinas/injetores
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IGNIÃ‡ÃƒO/INJEÃ‡ÃƒO    â”‚
â”‚   (Hardware)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


# ğŸï¸ Sistema de ComunicaÃ§Ã£o Serial para ECU

Sistema de comunicaÃ§Ã£o serial para configuraÃ§Ã£o de ECU (Electronic Control Unit) para motores de combustÃ£o interna.

## ğŸ“‹ Ãndice

- [Sobre](#sobre)
- [CaracterÃ­sticas](#caracterÃ­sticas)
- [InstalaÃ§Ã£o](#instalaÃ§Ã£o)
- [Protocolo de ComunicaÃ§Ã£o](#protocolo-de-comunicaÃ§Ã£o)
- [Comandos DisponÃ­veis](#comandos-disponÃ­veis)
- [Exemplos de Uso](#exemplos-de-uso)
- [API Reference](#api-reference)
- [ContribuiÃ§Ã£o](#contribuiÃ§Ã£o)
- [LicenÃ§a](#licenÃ§a)

## ğŸ¯ Sobre

Este projeto implementa um sistema de comunicaÃ§Ã£o serial robusto para configuraÃ§Ã£o de ECUs automotivas, permitindo:

- âœ… ConfiguraÃ§Ã£o de mapas de igniÃ§Ã£o e injeÃ§Ã£o
- âœ… CalibraÃ§Ã£o de sensores (TPS, MAP, CLT)
- âœ… Sistema de proteÃ§Ã£o do motor
- âœ… Monitoramento em tempo real
- âœ… Armazenamento permanente (EEPROM)

## ğŸš€ CaracterÃ­sticas

### Sistema de IgniÃ§Ã£o
- Suporte a centelha perdida e Ãºnica
- Mapas 3D de avanÃ§o (16x16)
- ConfiguraÃ§Ã£o de dwell
- ProteÃ§Ã£o por RPM

### Sistema de InjeÃ§Ã£o
- Modos: Pareado, Semi-sequencial, Sequencial
- CÃ¡lculo automÃ¡tico de REQ_FUEL
- Enriquecimento na aceleraÃ§Ã£o
- Suporte a diferentes combustÃ­veis

### Sensores Suportados
- **TPS** (Throttle Position Sensor)
- **MAP** (Manifold Absolute Pressure)
- **CLT** (Coolant Temperature)

## ğŸ“¦ InstalaÃ§Ã£o

1. Clone o repositÃ³rio:
```bash
git clone https://github.com/deson00/Autoino.git
```

2. Abra o arquivo no Arduino IDE

3. Configure a porta serial e faÃ§a o upload

## ğŸ“¡ Protocolo de ComunicaÃ§Ã£o

### Formato Geral
```
COMANDO,valor1,valor2,...,valorN;
```

- **COMANDO**: Letra identificadora (a-z)
- **Valores**: NÃºmeros separados por vÃ­rgula
- **Terminador**: Ponto e vÃ­rgula (`;`)

### Exemplo
```
a,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170;
```

## ğŸ”§ Comandos DisponÃ­veis

### ğŸ“Š Tabelas de CalibraÃ§Ã£o

| Comando | FunÃ§Ã£o | Formato |
|---------|--------|---------|
| `a` | MAP/TPS IgniÃ§Ã£o | `a,val1,val2,...,val16;` |
| `b` | RPM IgniÃ§Ã£o | `b,500,1000,1500,...;` |
| `c` | Matriz AvanÃ§o | `c,val1,val2,...,val256;` |
| `d` | MAP/TPS VE | `d,val1,val2,...,val16;` |
| `e` | RPM VE | `e,500,1000,1500,...;` |
| `f` | Matriz VE | `f,val1,val2,...,val256;` |

### âš™ï¸ ConfiguraÃ§Ãµes do Sistema

<details>
<summary><b>ConfiguraÃ§Ã£o Inicial (g)</b></summary>

```
g,tipo_igniÃ§Ã£o,qtd_dentes,local_roda_fonica,qtd_dentes_faltantes,grau_pms,qtd_cilindros;
```

**ParÃ¢metros:**
- `tipo_igniÃ§Ã£o`: Tipo do sistema
- `qtd_dentes`: Dentes da roda fÃ´nica
- `local_roda_fonica`: 2=virabrequim, 1=comando
- `qtd_dentes_faltantes`: Dentes ausentes
- `grau_pms`: Graus do PMS
- `qtd_cilindros`: NÃºmero de cilindros

</details>

<details>
<summary><b>ConfiguraÃ§Ã£o IgniÃ§Ã£o (j)</b></summary>

```
j,referÃªncia,modo,avanÃ§o_partida,avanÃ§o_fixo,grau_fixo,tipo_sinal;
```

**ParÃ¢metros:**
- `referÃªncia`: 1=MAP, 2=TPS
- `modo`: 1=centelha perdida, 2=Ãºnica
- `avanÃ§o_partida`: Graus na partida
- `avanÃ§o_fixo`: 0=off, 1=on
- `grau_fixo`: Valor fixo (0-360Â°)
- `tipo_sinal`: 1=alto, 0=baixo

</details>

<details>
<summary><b>Outros Comandos</b></summary>

| Comando | FunÃ§Ã£o | ParÃ¢metros |
|---------|--------|------------|
| `k` | Dwell | partida,funcionamento |
| `l` | Sensor CLT | temp1,res1,temp2,res2 |
| `m` | InjeÃ§Ã£o | 13 parÃ¢metros |
| `n` | ProteÃ§Ã£o | 7 parÃ¢metros |
| `o` | Enriquecimento | 17 parÃ¢metros |
| `p` | TPS | min,max |
| `q` | MAP | tipo,min,max |

</details>

### ğŸ® Comandos de Controle

| Comando | FunÃ§Ã£o |
|---------|--------|
| `h` | ğŸ“¤ LÃª dados da ECU |
| `i` | ğŸ“Š Toggle dados tempo real |
| `z` | ğŸ’¾ Salva na EEPROM |

## ğŸ“ Exemplos de Uso

### ConfiguraÃ§Ã£o BÃ¡sica

```bash
# 1. Motor 4 cilindros, roda fÃ´nica 60-2
g,1,60,2,2,10,4;

# 2. IgniÃ§Ã£o por MAP, centelha perdida
j,1,1,10,0,0,1;

# 3. ConfiguraÃ§Ã£o TPS (0-1023)
p,0,1023;

# 4. Salvar configuraÃ§Ãµes
z
```

### Carregamento de Mapa

```bash
# RPM da tabela de igniÃ§Ã£o
b,800,1000,1500,2000,2500,3000,3500,4000,4500,5000,5500,6000,6500,7000,7500,8000;

# MAP/TPS da tabela de igniÃ§Ã£o  
a,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170;

# Matriz de avanÃ§o (exemplo com 16 valores, na prÃ¡tica sÃ£o 256)
c,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40;

# Salvar
z
```

### Monitoramento

```bash
# Ativar dados em tempo real
i

# Ler dados salvos
h
```

## ğŸ“– API Reference

### FunÃ§Ã£o Principal

```cpp
void leitura_entrada_dados_serial()
```

Processa dados recebidos via Serial e executa comandos correspondentes.

### VariÃ¡veis Globais Importantes

```cpp
// Tabelas de calibraÃ§Ã£o
int vetor_rpm[16];              // RPM para igniÃ§Ã£o
int vetor_map_tps[16];          // MAP/TPS para igniÃ§Ã£o
int matriz_avanco[16][16];      // Matriz de avanÃ§o

// ConfiguraÃ§Ãµes
int tipo_ignicao;               // Tipo de igniÃ§Ã£o
int qtd_cilindro;              // Quantidade de cilindros
bool status_dados_tempo_real;   // Status monitoramento
```

## ğŸ› ï¸ Desenvolvimento

### Estrutura do Projeto
ENDEREÃ‡OS EEPROM - LAYOUT REORGANIZADO:
0-9      : Reservados
10-41    : vetor_rpm igniÃ§Ã£o (16 x 2 bytes = 32 bytes)
50-65    : vetor_map_tps igniÃ§Ã£o (16 x 1 byte = 16 bytes) 
100-355  : matriz_avanco (16x16 x 1 byte = 256 bytes)
360-371  : configuracao_inicial (12 bytes)
380-391  : configuracao_faisca (12 bytes)
400-403  : configuracao_dwell (4 bytes)
410-417  : configuracao_clt (8 bytes)

500-531  : vetor_rpm_ve (16 x 2 bytes = 32 bytes)
540-555  : vetor_map_tps_ve (16 x 1 byte = 16 bytes)
600-855  : matriz_ve (16x16 x 1 byte = 256 bytes)

900-917  : configuracao_injecao (18 bytes) - MOVIDO PARA EVITAR CONFLITO
950-958  : configuracao_protecao (9 bytes)
970-991  : enriquecimento_aceleracao (22 bytes)
1000-1003: configuracao_tps (4 bytes)
1010-1014: configuracao_map (5 bytes)
```
ecu-serial-communication/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.cpp
â”‚   â”œâ”€â”€ serial_handler.cpp
â”‚   â””â”€â”€ eeprom_manager.cpp
â”œâ”€â”€ include/
â”‚   â””â”€â”€ config.h
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ basic_setup.ino
â””â”€â”€ README.md
```

### CompilaÃ§Ã£o

Requisitos:
- Arduino IDE 1.8.0+
- Placa compatÃ­vel (Arduino Uno, Mega, etc.)

## ğŸ¤ ContribuiÃ§Ã£o

1. FaÃ§a um Fork do projeto
2. Crie sua Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudanÃ§as (`git commit -m 'Add some AmazingFeature'`)
4. Push para a Branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

### ğŸ“‹ Diretrizes

- Siga o padrÃ£o de cÃ³digo existente
- Adicione testes para novas funcionalidades  
- Documente mudanÃ§as no CHANGELOG.md
- Use commits semÃ¢nticos

## ğŸ› Problemas Conhecidos

- [ ] Buffer overflow em strings muito longas
- [ ] ValidaÃ§Ã£o limitada de entrada
- [ ] Sem checksum nos dados

## ğŸ“ˆ Roadmap

- [ ] Interface grÃ¡fica para configuraÃ§Ã£o
- [ ] Suporte a CAN Bus
- [ ] Datalog integrado  
- [ ] Simulador de ECU
- [ ] Testes automatizados

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ licenciado sob a LicenÃ§a MIT - veja o arquivo [LICENSE](LICENSE) para detalhes.

## ğŸ‘¥ Autores

- **Seu Nome** - *Trabalho inicial* - [SeuGitHub](https://github.com/seu-usuario)

## ğŸ™ Agradecimentos

- Comunidade Arduino
- Desenvolvedores de ECUs open source
- Contribuidores do projeto

---

<div align="center">

**[â¬† Voltar ao topo](#sistema-de-comunicaÃ§Ã£o-serial-para-ecu)**

Made with â¤ï¸ for the automotive community

</div>